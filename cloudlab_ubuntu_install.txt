
# Sources
$ https://davidaugustat.com/linux/how-to-compile-linux-kernel-on-ubuntu
$ https://pages.cs.wisc.edu/~markm/kernel-build-cloudlab.html
$ https://github.com/dicksites/KUtrace/blob/master/docs/linux_patches_installation_guide.pdf


# Prereqs
$ sudo apt update 
$ sudo apt install build-essential libncurses-dev bison flex libssl-dev libelf-dev fakeroot
$ sudo apt install dwarves


# Start - Install Unpatched Kernel

Get Kernel tar 
$ wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.15.89.tar.xz
$ tar -xf linux-5.15.89.tar.gz

Configure Kernel

$ cd linux-5.15.89

Copy current kernel config
$ cp -v /boot/config-$(uname -r) .config

Use localmodeconfig to only select currently utilized modules
$ make localmodeconfig
$ (press enter for every option)

Modify config to allow build disable certificate stuff
$ scripts/config --disable SYSTEM_TRUSTED_KEYS
$ scripts/config --disable SYSTEM_REVOCATION_KEYS
$ scripts/config --set-str CONFIG_SYSTEM_TRUSTED_KEYS ""
$ scripts/config --set-str CONFIG_SYSTEM_REVOCATION_KEYS ""

Compile the kernel
$ fakeroot make -j${NUM_PROCS} LOCALVERSION=${KERNEL_NAME_APPED}

Build successful if following command returns 0
$ echo $?

# Install
Kernel modules
$ sudo make modules_install
Kernel itself
$ sudo make install
Reboot
$ sudo reboot
Confirm install
$ uname -rs


